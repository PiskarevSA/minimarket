## Структура проекта и назначение директорий

Проект структурирован следующим образом. Развернутое описание

```
├── cmd
│   └── minimarket
├── microservices
│   └── my-microservice
│       ├── cli
│       ├── internal
│       │   ├── config
│       │   ├── entities
│       │   ├── handlers
│       │   │   └── oapi
│       │   ├── storage
│       │   │   └── postgre
│       │   │       └── sqlc
│       │   └── usecases
│       ├── oapi
│       │   ├── components
│       │   │   ├── headers
│       │   │   ├── requests
│       │   │   ├── responses
│       │   │   └── schemas
│       │   └── paths
│       └── sql
│           ├── migrations
│           └── queries
└── pkg
    └── ...
```

---

`cmd/minimarket` - в папке находится код инициализации CLI для управления микросервисами. В файл `main.go` импортируются суб-модули CLI микросервисов, а затем объединяются в единую консольную утилиту.  

---

`microservices` - в папке находится код микросервисов. Каждый микросервис представлен отдельной папкой. Папки микросервисов имеют определенную структуру. В них в обязательном порядке есть следующие компоненты:
   
1. `cli` - в папке находится код для управления микросервисом через CLI. CLI представлен ввиде переменной типа `*cli.Command` из библиотеки github.com/urfave/cli/v3. Данная переменная экспортируется на уровень выше, в `cmd/minimarket`, и включается в глобальный CLI.
2. `internal` - в папке находится основной код приложения, разделенный на несколько слоев. 
   * `config` - в папке расположен представленный виде структуры конфиг микросервиса. Конфиг инициализирован как глобальная переменная на уровне данного пакета. Доступ к конфигу из других частей приложения происходит через обращение к функциям-геттерам. 
   * `entities` - в папке расположены типы, которые представляют бизнес-сущности. К примеру, в ней может быть распложена структура `User`, служащая для представления пользователя.
   * `handlers` - в папке расположен код, который отвечает за прием и первичную обработку данных, полученных по HTTP. Полученные данные передаются на другой слой, в `usecase`, где происходят дальнейшие манипуляции и откуда возвращаются данные для ответа на запрос. Все хендлеры имеют представление ввиде шаблонного кода, сгенерированного при помощи [oapi-codgen](github.com/oapi-codegen/oapi-codegen).
     * `oapi` - в папке расположен шаблонный код хендлеров, сгенерированный при помощи oapi-codgen.
   * `storage` - в папке расположен код для взаимодействия со временными или постоянными хранилищами данных.
     * `postgre` - в папке расположен код для взаимодейтсвия с базой данных PostgreSQL. Основная логика запросов к PostgreSQL описана в "сырых" SQL файлах в папке `sql`, которая находится на корневом уровне папки микросервиса. Трансляция SQL в go-код происходит при помощи [sqlc](github.com/sqlc-dev/sqlc).
       * `sqlc` - в папке расположен шаблонный код для взаимодейтсвия с базой данных PostgreSQL, сгенерированный при помощи sqlc.
   * `usecases` - в папке находится код приложения, который ответственен за выполнение бизнес-функций микросервиса. Он служит связующим звеном между хенлерами, хранилищем и другими компонентами системы.
3. `oapi` -  папке находятся файлы с описанием эндпоинтов в формате [openapi](https://learn.openapis.org/). На их основе генерируется go-код при помощи инструмента [oapi-codegen](https://github.com/oapi-codegen/oapi-codegen).
4. `sql` - в папке находятся файлы с миграциями и запросами к базе данных. На их основе генерируется go-код при помощи инструмента [sqlc](https://github.com/sqlc-dev/sqlc).
5. `oapi-config.yaml` - конфигурационный файл для oapi-codegen.
6. `sqlc.yaml` - конфигурационный файл для sqlc.
7. `Taskfile.yaml` - конфигурационный файл для утилиты [Task](https://taskfile.dev/) (аналог make).

---

`microservices/auth` - в папке находится код микросервиса, который ответственен за авторизацию и аутентификацию. К примеру, к нему происходит обращение при: регистрации пользователя; входе пользователя в систему; выхода пользователя из системы и пр.

---

`microservices/points` - в папке находится код микросервиса, который ответственен за работу с бонусными баллами. К примеру, к нему проиходит обращение при: зачислении или списании бонусных баллов; получении пользователем текущего количества бонусных баллов и пр. 

---

`microservices/points-calc` - в папке находится код микросервиса, который ответственен за расчеты, которые связаны с бонусными баллами. К примеру, он подсчитывает, сколько поинтов нужно начислить за заказ товара и пр.
