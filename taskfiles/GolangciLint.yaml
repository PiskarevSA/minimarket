version: "3.0"

tasks:
  run:
    cmds:
      - task: run-lint

  run-lint:
    desc: |
      Run golangci-lint from docker container to lint go files in workspace.
    cmds:
      - >
        docker run -t --rm
        -v $(pwd):/app
        -v $(go env GOCACHE):/cache/go
        -e GOCACHE=/cache/go
        -e GOLANGCI_LINT_CACHE=/cache/go
        -v ${GOPATH}/pkg:/go/pkg
        -w /app
        golangci/golangci-lint:latest
        golangci-lint run --fix
